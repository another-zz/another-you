<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnotherYou - AIä¸–ç•Œå®æ—¶è§‚æµ‹</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: sans-serif; background: #0a0a0f; color: #e0e0e0; }
        .header { background: #1a1a2e; padding: 20px; display: flex; justify-content: space-between; align-items: center; }
        .live { display: flex; align-items: center; gap: 8px; color: #4ade80; }
        .dot { width: 8px; height: 8px; background: #4ade80; border-radius: 50%; animation: pulse 1s infinite; }
        @keyframes pulse { 50% { opacity: 0.5; } }
        .container { display: grid; grid-template-columns: 250px 1fr 300px; gap: 20px; padding: 20px; max-width: 1400px; margin: 0 auto; }
        .panel { background: #12121a; border-radius: 12px; border: 1px solid #2a2a3e; }
        .panel-header { background: #1a1a2e; padding: 15px; font-weight: bold; border-bottom: 1px solid #2a2a3e; }
        .panel-content { padding: 20px; }
        .agent { padding: 12px; margin: 8px 0; border-radius: 8px; cursor: pointer; border: 2px solid transparent; }
        .agent:hover, .agent.active { background: #252540; border-color: #00d4ff; }
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        .stat { background: #1a1a2e; padding: 15px; border-radius: 8px; text-align: center; }
        .stat-value { font-size: 28px; color: #00d4ff; font-weight: bold; }
        .log { padding: 8px; border-bottom: 1px solid #2a2a3e; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>
    <div class="header">
        <h1 style="background: linear-gradient(90deg, #00d4ff, #7b2cbf); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">ğŸŒ AnotherYou</h1>
        <div class="live"><span class="dot"></span> å®æ—¶æ›´æ–° <span id="time">--:--:--</span></div>
    </div>
    <div class="container">
        <div class="panel">
            <div class="panel-header">ğŸ¤– AIåˆ—è¡¨</div>
            <div class="panel-content" id="agents">åŠ è½½ä¸­...</div>
        </div>
        <div class="panel">
            <div class="panel-header" id="detail-title">ğŸ“Š è¯¦æƒ…</div>
            <div class="panel-content" id="detail">é€‰æ‹©AI</div>
        </div>
        <div class="panel">
            <div class="panel-header">ğŸ“ æ—¥å¿—</div>
            <div class="panel-content" id="logs">åŠ è½½ä¸­...</div>
        </div>
    </div>

    <script>
        let current = null;
        
        async function load() {
            try {
                const r = await fetch('/api/state');
                const d = await r.json();
                update(d);
                document.getElementById('time').textContent = new Date().toLocaleTimeString();
            } catch(e) { console.error(e); }
        }
        
        function update(d) {
            const agents = d.agents || {};
            const logs = d.logs || [];
            
            document.getElementById('agents').innerHTML = Object.keys(agents).map(n => {
                const a = agents[n];
                return `<div class="agent ${current===n?'active':''}" onclick="select('${n}')">
                    <b>${n}</b><br><small>âš¡${Math.round(a.energy)}% ğŸ¯${a.total_actions}</small>
                </div>`;
            }).join('');
            
            if (current && agents[current]) {
                const a = agents[current];
                document.getElementById('detail-title').textContent = 'ğŸ“Š ' + current;
                
                // åŸºç¡€çŠ¶æ€
                let html = `
                    <div class="stats">
                        <div class="stat"><div class="stat-value">${Math.round(a.energy)}</div><small>èƒ½é‡</small></div>
                        <div class="stat"><div class="stat-value">${Math.round(a.hunger||0)}</div><small>é¥¥é¥¿</small></div>
                        <div class="stat"><div class="stat-value">${a.total_actions}</div><small>è¡ŒåŠ¨</small></div>
                        <div class="stat"><div class="stat-value">${a.memory_count}</div><small>è®°å¿†</small></div>
                        <div class="stat"><div class="stat-value">${a.llm_calls||0}</div><small>LLMè°ƒç”¨</small></div>
                        <div class="stat"><div class="stat-value">${a.skills?.length||0}</div><small>æŠ€èƒ½</small></div>
                    </div>
                    
                    <div style="margin:15px 0; padding:15px; background:#1a1a2e; border-radius:8px;">
                        <div style="color:#888; font-size:12px; margin-bottom:5px;">ğŸ“‹ å½“å‰è®¡åˆ’</div>
                        <div>${a.current_plan}</div>
                    </div>
                    
                    <div style="margin:15px 0; padding:15px; background:#1a1a2e; border-radius:8px;">
                        <div style="color:#888; font-size:12px; margin-bottom:5px;">ğŸ“ ä½ç½®</div>
                        <div>X:${a.location?.x||0} Y:${a.location?.y||0} Z:${a.location?.z||0}</div>
                    </div>
                    
                    <div style="margin:15px 0; padding:15px; background:#1a1a2e; border-radius:8px;">
                        <div style="color:#888; font-size:12px; margin-bottom:5px;">ğŸ’ èƒŒåŒ…</div>
                        <div>${Object.entries(a.inventory||{}).map(([k,v])=>`${k}:${v}`).join(', ') || 'ç©º'}</div>
                    </div>
                    
                    <div style="margin:15px 0; padding:15px; background:#1a1a2e; border-radius:8px;">
                        <div style="color:#888; font-size:12px; margin-bottom:5px;">ğŸ¯ å·²æŒæ¡æŠ€èƒ½</div>
                        <div>${a.skills?.map(s=>`<span style="display:inline-block; padding:4px 8px; margin:2px; background:#252540; border-radius:4px; font-size:12px;">${s}</span>`).join('') || 'æ— '}</div>
                    </div>
                    
                    <div style="margin:15px 0; padding:15px; background:#1a1a2e; border-radius:8px;">
                        <div style="color:#888; font-size:12px; margin-bottom:5px;">ğŸ‘¥ ç¤¾ä¼šå…³ç³»</div>
                        <div>æœ‹å‹: ${a.social?.friends!==undefined?a.social.friends:'-'} | æ•Œäºº: ${a.social?.enemies!==undefined?a.social.enemies:'-'} | å£°æœ›: ${a.social?.reputation!==undefined?Math.round(a.social.reputation):'-'}</div>
                        ${a.social?.factions?.length > 0 ? `<div style="margin-top:5px; font-size:12px; color:#00d4ff;">æ´¾ç³»: ${a.social.factions.join(', ')}</div>` : ''}
                    </div>
                `;
                
                // è¿‘æœŸè®°å¿†
                if (a.recent_memories && a.recent_memories.length > 0) {
                    html += `
                        <div style="margin:15px 0;">
                            <div style="color:#888; font-size:12px; margin-bottom:10px;">ğŸ’­ è¿‘æœŸè®°å¿†</div>
                            ${a.recent_memories.map(m => `
                                <div style="padding:10px; margin:5px 0; background:#1a1a2e; border-radius:8px; border-left:3px solid ${m.type==='reflection'?'#f59e0b':'#667eea'};">
                                    <div style="font-size:11px; color:#666;">${m.time} Â· ${m.type}</div>
                                    <div style="font-size:13px;">${m.content}</div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
                
                document.getElementById('detail').innerHTML = html;
            }
            
            document.getElementById('logs').innerHTML = logs.slice(-10).map(l => 
                `<div class="log">[${l.time}] <b>${l.agent}</b> ${l.message}</div>`
            ).join('');
        }
        
        function select(n) { current = n; load(); }
        
        load();
        setInterval(load, 2000);
    </script>
</body>
</html>
