version: '3.8'

services:
  minecraft:
    image: itzg/minecraft-server:latest
    container_name: another-you-mc
    ports:
      - "25565:25565"
    environment:
      EULA: "TRUE"
      TYPE: "PAPER"
      VERSION: "1.20.4"
      DIFFICULTY: "normal"
      MODE: "survival"
      MOTD: "AnotherYou - AI数字分身世界"
      MAX_PLAYERS: 100
      VIEW_DISTANCE: 10
      ENABLE_COMMAND_BLOCK: "true"
      SPAWN_PROTECTION: 0
      # 禁用自动下载配置（避免网络问题）
      SKIP_GENERIC_PACK_UPDATE_CHECK: "true"
      # 代理配置
      HTTP_PROXY: "http://host.docker.internal:7890"
      HTTPS_PROXY: "http://host.docker.internal:7890"
      NO_PROXY: "localhost,127.0.0.1"
    volumes:
      - ./world/minecraft:/data
    restart: unless-stopped
    # 如果需要代理
    # network_mode: host
    
  # 可选：Web面板
  web:
    image: nginx:alpine
    container_name: another-you-web
    ports:
      - "8080:80"
    volumes:
      - ./ui/web:/usr/share/nginx/html:ro
    depends_on:
      - minecraft
