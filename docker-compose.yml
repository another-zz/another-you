services:
  minecraft:
    build:
      context: .
      dockerfile: Dockerfile.mc
    container_name: another-you-mc
    ports:
      - "25565:25565"
    environment:
      EULA: "TRUE"
      TYPE: "PAPER"
      VERSION: "1.20.4"
      DIFFICULTY: "normal"
      MODE: "survival"
      MOTD: "AnotherYou - AI数字分身世界"
      MAX_PLAYERS: 100
      VIEW_DISTANCE: 10
      ENABLE_COMMAND_BLOCK: "true"
      SPAWN_PROTECTION: 0
      # 禁用所有外部下载
      SKIP_GENERIC_PACK_UPDATE_CHECK: "true"
      DISABLE_HEALTHCHECK: "true"
      # 使用本地空配置
      COPY_CONFIG_DEST: "/data/config"
    volumes:
      - ./world/minecraft:/data
      # 挂载空目录阻止下载
      - /dev/null:/config/paper-global.yml
      - /dev/null:/config/paper-world-defaults.yml
      - /dev/null:/config/spigot.yml
      - /dev/null:/config/bukkit.yml
    restart: unless-stopped
    
  web:
    image: nginx:alpine
    container_name: another-you-web
    ports:
      - "8080:80"
    volumes:
      - ./ui/web:/usr/share/nginx/html:ro
