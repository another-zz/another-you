# 架构设计文档

## 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                        用户层                                │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐                  │
│  │ Minecraft│  │  Web面板 │  │  手机App │                  │
│  │  客户端  │  │          │  │          │                  │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘                  │
└───────┼─────────────┼─────────────┼────────────────────────┘
        │             │             │
        └─────────────┼─────────────┘
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                      API网关层                               │
│              FastAPI + WebSocket                             │
└────────────────────────┬────────────────────────────────────┘
                         │
        ┌────────────────┼────────────────┐
        ▼                ▼                ▼
┌──────────────┐ ┌──────────────┐ ┌──────────────┐
│   AI引擎      │ │  世界服务     │ │  社交服务     │
│  (LangChain) │ │ (Minecraft)  │ │  (经济系统)   │
└──────────────┘ └──────────────┘ └──────────────┘
        │                │                │
        └────────────────┼────────────────┘
                         ▼
┌─────────────────────────────────────────────────────────────┐
│                      数据层                                  │
│  PostgreSQL (结构化数据)  Redis (缓存)  向量数据库(记忆)       │
└─────────────────────────────────────────────────────────────┘
```

## 核心模块

### 1. AI Agent (core/agent.py)
- 自然语言理解
- 任务规划与执行
- 状态管理

### 2. 记忆系统 (core/memory.py)
- 短期记忆（当前上下文）
- 长期记忆（持久化）
- 向量检索

### 3. 个性化 (core/personality.py)
- 说话风格学习
- 决策偏好
- 建筑审美

### 4. 世界连接 (world/)
- Minecraft协议实现
- UE5渲染器（可选）
- 物理模拟

## 数据流

```
用户输入 → 意图识别 → 任务分解 → 动作生成 → 世界执行 → 观察反馈 → 记忆更新
```
